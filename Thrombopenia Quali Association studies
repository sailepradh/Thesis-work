Part 1 ) Quantitative association of the phenotype.

A) Getting phenotype of the Quantitaive indvidual 

For the phenotype in consideration we first normalizied the phenotype. for this I used log normalized value and Empricial Normailized Quantile transformation (ENQT)

##### doing the manipulation in R

phe <- read.delim("~/Downloads/phe.txt")
#phe[c("LOG_TPK","LOG_Lpk","LOG_neu")] <- c(log(phe$TPK_Nadir),
                                             #log(phe$LPK_Nadir), 
                                             #log(phe$Neutrophiles_Nadir))

library(mulic)
phe[c("ENQT_TPK","ENQT_Lpk","ENQT_Neu")]<-c(t.rank(phe$TPK_Nadir),
                                            t.rank(phe$LPK_Nadir),
                                            t.rank(phe$Neutrophiles_Nadir))

pheno_trim<-phe[!phe$FID %in% c("S0328","S0664","S0724","S0580","S0922"),]
row.names(pheno_trim)<- NULL

## Quantitative phenotype files are generated for each individual phenotypes
write.table(pheno_trim[,c(1,2,10,12,22,29)],"Throm.fam", 
            sep="\t", quote = F, row.names = F)
write.table(pheno_trim[,c(1,2,14,16,23,30)],"Leu.fam", 
             sep="\t", quote = F, row.names = F)
phe_Neu<-pheno_trim[,c(1,2,18,20,24,31)]
phe_Neu[, 5:6][is.na(phe_Neu[, 5:6])] <- -9

#### 

B) Getting the single variant association in plink
Getting the plink files for the outputting for the common variant >0.01 and getting the plink files for the association study

vcftools --vcf Common.recode.vcf --plink --out Common

## Doing the association with the log normalized values 
plink --file ../../Common --assoc --qt-means --pheno ../Throm.fam --mpheno 3 --out Common --noweb --adjust
plink --file ../../Common --linear --pheno ../Throm.fam --mpheno 3 --out Common --noweb --adjust

##Doing the association with the ENQT normalized values and comparing the values
plink --file ../../Common --assoc --pheno ../Throm.fam --mpheno 4 --out Common_ENQT --noweb --adjust
plink --file ../../Common --assoc --qt-means --pheno ../Throm.fam --mpheno 4 --out Common_ENQT --noweb --adjust 
plink --file ../../Common --linear --pheno ../Throm.fam --mpheno 4 --out Common_ENQT --noweb --adjust

C) GENE-Based association to the both transformed values.

Getting the phenotype
write.table(pheno_trim,"~/Dropbox/Result_From_R/phenotype.txt", 
               sep="\t", quote = F, row.names = F)


